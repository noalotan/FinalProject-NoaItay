pipeline {
    agent any  // This defines where the pipeline will run; "any" lets Jenkins decide.
    stages {  // Stages are the main steps in the CI pipeline.
        stage('Install Dependencies') {  // First stage: Install Python packages
            steps {
                // Install necessary Python packages
                sh 'pip3 install -r opt/status-page/requirements.txt'
                sh 'pip3 install flake8 black'
            }
        }
        stage('Lint Code') {  // Second stage: Linting
            steps {
                dir('opt/status-page') {
                    // Run flake8 to check for code style issues
                    sh 'flake8 .'
                
                    // Run black in check-only mode to verify code formatting
                    sh 'black --check .'
                }
            }
        }
        stage('Run Tests') {  // Third stage: Testing
            steps {
                dir('opt/status-page')
                    // Run Django tests
                    sh 'python manage.py test'
                }
            }
        }
    }
        success {
            echo 'All stages passed successfully!'
        }
        failure {
            echo 'One or more stages failed.'
        }
    }
}
